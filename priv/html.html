<!DOCTYPE html>
<!-- @todo: Use html5boilerplate -->
<html class="no-js">
    <head>
        <style>
            .no-websockets #status {display:none;}
            .websockets #telnet {display:none;}
        </style>
        <!-- @todo: grab custom modernizr for websocket support -->
        <script src="http://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.1/modernizr.min.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7/jquery.min.js"></script>
        <!-- @todo: setup cowboy to serve static content so I can source this js file -->
        <script type="text/javascript">
            function ready(){
                if (Modernizr.websockets) {
                    // browser supports websockets
                    var ws = new WebSocket(document.location.toString().replace("http:", "ws:"));
                    ws.onopen = function() {
                        // websocket is connected
                        $("#status").html("websocket connected!<br/>");
                        // send hello data to server.
                        ws.send("hello server!");
                    };
                    ws.onmessage = function (evt) {
                        var receivedMsg = evt.data;
                        $("#status").append(receivedMsg + "<br/>");
                    };
                    ws.onclose = function() {
                        // websocket was closed
                        $("#status").append("websocket was closed");
                    };
                }
            }
        </script>
    </head>
    <body onload="ready();">
        <div id="telnet">
            Oh dear. It appears you don't support websockets. Perhaps you might want to upgrade to a new browser that does support them, or try telnet?
        </div>
        <div id="status"></div>
    </body>
</html>
